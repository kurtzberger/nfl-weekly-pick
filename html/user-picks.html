<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0">
    <meta name="description" content="Weekly Pick 'em">
    <meta name="author" content="Eric Kurtzberg">
    <title>Your Weekly Picks</title>
	<!--Import Google Icon Font and Custom Icons-->
	<link href="https://rawgit.com/Templarian/MaterialDesign-Webfont/master/css/materialdesignicons.min.css" media="all" rel="stylesheet" type="text/css">
    <!--Import materialize.css-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/css/materialize.min.css" media="screen,projection">
	<link rel="stylesheet" type="text/css" href="../css/main.css">
</head>

<body>
	<nav class="top-nav deep-orange darken-4">
		<a id="title" class="brand-logo center"></a>
		<a data-activates="menu-nav" class="button-collapse show-on-large" style="transform: translateX(0px);"><i class="mdi mdi-menu"></i></a>
		<ul id="menu-nav" class="side-nav orange lighten-5">
			<li class="no-padding">
				<ul class="collapsible collapsible-accordion">
					<li id="league-picks-li">
						<a class="collapsible-header waves-effect"><i class="mdi mdi-football"></i><b>League Picks</b></a>
						<div class="collapsible-body white" style="display: block;">
							<ul id="weeks-list"></ul>
						</div>
					</li>
				</ul>
			</li>
			<li id="standings-li">
				<a id="standings-link" class="waves-effect"><i class="mdi mdi-format-list-numbers left"></i><b>Standings</b></a>
			</li>
            <li id="user-picks-li">
            	<a id="user-picks-link" class="waves-effect deep-orange lighten-3"><i class="mdi mdi-checkbox-marked-circle left"></i><b>Your Picks</b></a>
            </li>
			<li id="register-li">
				<a id="register-link" class="waves-effect"><i class="mdi mdi-pencil left"></i><b>Register</b></a>
			</li>
			<li id="login-li">
				<a id="login-logoff" class="waves-effect"><i class="mdi mdi-account left"></i><b>Logoff</b></a>
			</li>
		</ul>
	</nav>
	
	<!--Import jQuery before materialize.js-->
	<script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
	<!-- Compiled and minified JavaScript -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.6/js/materialize.min.js"></script>
	<!--Firebase import-->
	<script src="https://www.gstatic.com/firebasejs/3.0.0/firebase.js"></script>
	<script type="text/javascript" src="../js/init.js"></script>
	<script type="text/javascript" src="../js/links.js"></script>
	<script type="text/javascript" src="../js/functions.js"></script>
	
	<div id="main-content" class="container" style="width:auto;">
		<div class="row">
			<table id="picks" class="striped responsive-table">
				<thead>
					<tr>
						<th data-field="date">Date</th>
						<th data-field="awayLogo">Away</th>
						<th data-field="awayName"></th>
						<th data-field="homeLogo">Home</th>
						<th data-field="homeName"></th>
						<th data-field="points">Assigned Points</th>
					</tr>
				</thead>
				<tbody id="body"></tbody>
			</table>
		</div>
	</div>
	
	<script>
		$(document).ready(function()
		{
			// add loader animation
			$("#main-content").append('<div class="loader s12 m4 center">' +
					'<div class="preloader-wrapper big active">' +
					'<div class="spinner-layer spinner-blue-only">' +
					'<div class="circle-clipper left">' +
					'<div class="circle"></div>' +
					'</div><div class="gap-patch">' +
					'<div class="circle"></div>' + 
					'</div><div class="circle-clipper right">' +
					'<div class="circle"></div></div></div></div></div>');
			// current NFL week
			var url = 'http://www.nfl.com/liveupdate/scorestrip/ss.xml'; 
			$.get(url, function( data )
			{
				//debugger;
				// load xml data into the table
				setTimeout(function() { xmlImport(data); }, 1000);
			});
			
			$('#main-content').on('change', 'select', function()
			{
				var Values = [];	// array of values
				var value, numberOfGames = $('#body tr').length;
				
				for(var i=0; i<=numberOfGames; i++)
				{
					// fill the array with all possible point values
					if(i==0)
						Values.push("");
					else
						Values.push(i);
				}
				
				for(var i=0; i<numberOfGames; i++)
				{
					value = $('#dropdown-' + i).val();									// get current selected value
					if(value != "")														// do not remove empty selection from array. This is always a valid selection in all elements.
						Values.splice(Values.indexOf(parseInt(value)), 1);				// remove selected value for array 
					$('#dropdown-' + i + ' option[value!="' + value + '"]').remove();	// remove all values EXCEPT selected
					if(value == "")
						$('#dropdown-' + i + ' option[value="' + value + '"]').remove();// remove empty selection from element (to be added back later). 
																						// if we don't remove the empty selection there will be a duplicate added in later.
				}
				for(var i=0; i<Values.length; i++)
				{
					for(var j=0; j<numberOfGames; j++)
					{
						value = $('#dropdown-' + j).val();
						//next two conditions insert selection options in order based on their value
						if(parseInt(value) > Values[i])
							$('<option value=' + Values[i] + '>' + Values[i] + '</option>').insertBefore($('#dropdown-' + j + ' option[value="' + value + '"]'));	// add smaller values before
						else
							$('#dropdown-' + j).append('<option value=' + Values[i] + '>' + Values[i] + '</option>');	// add larger values after
					}
				}
				$('select').material_select();	// update material select UI
			});
		});
	</script>
</body>
</html>
